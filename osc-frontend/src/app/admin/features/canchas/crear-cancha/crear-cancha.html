<div class="crear-cancha-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <button class="btn-back" (click)="cancelar()">
        <span class="material-icons">arrow_back</span>
      </button>
      <h1>{{ isEditMode ? 'Editar Cancha' : 'Creación de Canchas' }}</h1>
    </div>
  </div>

  <!-- Formulario -->
  <div class="form-container">
    <form (ngSubmit)="guardarCancha()" #canchaForm="ngForm">
      <!-- Fila 0: Imagen de la cancha -->
      <div class="form-row">
        <div class="form-group full-width">
          <label for="imagen">Imagen de la cancha</label>
          <div class="image-upload-container">
            <div class="image-preview" *ngIf="imagenPreview">
              <img [src]="imagenPreview" alt="Preview">
              <button type="button" class="btn-remove-image" (click)="eliminarImagen()">
                <span class="material-icons">close</span>
              </button>
            </div>
            <div class="upload-area" *ngIf="!imagenPreview" (click)="fileInput.click()">
              <span class="material-icons">add_photo_alternate</span>
              <p>Haz clic para seleccionar una imagen</p>
              <span class="upload-hint">JPG, PNG o WEBP (máx. 5MB)</span>
            </div>
            <input 
              #fileInput
              type="file" 
              id="imagen"
              name="imagen"
              accept="image/jpeg,image/png,image/webp"
              (change)="onImageSelected($event)"
              style="display: none;"
            />
          </div>
        </div>
      </div>

      <!-- Fila 1: Nombre y Deporte -->
      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre de la cancha</label>
          <input 
            type="text" 
            id="nombre"
            name="nombre"
            [(ngModel)]="canchaData.nombre_cancha"
            placeholder="Ej: Cancha 1"
            required
            maxlength="100"
            #nombreInput="ngModel"
          />
          <div *ngIf="nombreInput.invalid && nombreInput.touched" class="error-message">
            <span class="material-icons">error</span>
            El nombre es obligatorio
          </div>
        </div>

        <div class="form-group">
          <label for="deporte">Deporte</label>
          <select 
            id="deporte"
            name="deporte"
            [(ngModel)]="canchaData.id_deporte"
            required
          >
            <option *ngFor="let deporte of deportes" [value]="deporte.id">
              {{ deporte.nombre }}
            </option>
          </select>
        </div>
      </div>

      <!-- Fila 2: Sede -->
      <div class="form-row">
        <div class="form-group full-width">
          <label for="sede">Sede</label>
          <select 
            id="sede"
            name="sede"
            [(ngModel)]="canchaData.id_sede"
            required
            #sedeInput="ngModel"
          >
            <option [value]="0" disabled>Seleccione una sede...</option>
            <option *ngFor="let sede of sedes" [value]="sede.id_sede">
              {{ sede.nombre_sede }}
            </option>
          </select>
          <div *ngIf="sedeInput.invalid && sedeInput.touched" class="error-message">
            <span class="material-icons">error</span>
            Debes seleccionar una sede
          </div>
        </div>
      </div>

      <!-- Fila 3: Largo y Ancho -->
      <div class="form-row">
        <div class="form-group">
          <label for="largo">Largo (m)</label>
          <input 
            type="number" 
            id="largo"
            name="largo"
            [(ngModel)]="canchaData.largo"
            min="1"
            max="200"
            required
          />
        </div>

        <div class="form-group">
          <label for="ancho">Ancho (m)</label>
          <input 
            type="number" 
            id="ancho"
            name="ancho"
            [(ngModel)]="canchaData.ancho"
            min="1"
            max="200"
            required
          />
        </div>
      </div>

      <!-- Fila 4: Tarifa, Tipo y Estado -->
      <div class="form-row three-cols">
        <div class="form-group">
          <label for="tarifa">Tarifa</label>
          <input 
            type="number" 
            id="tarifa"
            name="tarifa"
            [(ngModel)]="canchaData.tarifa"
            min="0"
            step="0.01"
            required
          />
        </div>

        <div class="form-group">
          <label for="tipo">Tipo</label>
          <select 
            id="tipo"
            name="tipo"
            [(ngModel)]="canchaData.tipo_superficie"
            required
          >
            <option *ngFor="let tipo of tiposSuperficie" [value]="tipo">
              {{ tipo }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="estado">Estado</label>
          <select 
            id="estado"
            name="estado"
            [(ngModel)]="canchaData.estado"
            required
          >
            <option *ngFor="let estado of estadosCancha" [value]="estado">
              {{ estado }}
            </option>
          </select>
        </div>
      </div>

      <!-- Botones -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn btn-cancelar"
          (click)="cancelar()"
          [disabled]="isLoading"
        >
          Cancelar
        </button>
        <button 
          type="submit" 
          class="btn btn-crear"
          [disabled]="isLoading || canchaForm.invalid"
        >
          <span class="spinner" *ngIf="isLoading"></span>
          <span *ngIf="!isLoading">{{ isEditMode ? 'Actualizar' : 'Crear' }}</span>
        </button>
      </div>
    </form>
  </div>
</div>
