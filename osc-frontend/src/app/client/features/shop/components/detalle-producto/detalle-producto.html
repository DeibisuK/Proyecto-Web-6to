<div class="detalle-producto-container" *ngIf="producto">
  <!-- Breadcrumb -->
  <nav class="breadcrumb">
    <a routerLink="/tienda">Tienda</a>
    <span class="breadcrumb-separator">/</span>
    <span class="current">{{producto.nombre}}</span>
  </nav>

  <div class="producto-content">
    <!-- Sección de Imagen -->
    <div class="imagen-section">
      <div class="imagen-principal">
        <img [src]="imagenPrincipal" [alt]="producto.nombre">
        <div class="badges">
          <span *ngIf="producto.nuevo" class="badge nuevo">Nuevo</span>
          <span *ngIf="producto.oferta" class="badge oferta">-{{calcularDescuento()}}%</span>
        </div>
      </div>
      <div class="imagenes-secundarias">
        <div class="imagen-miniatura active">
          <img [src]="producto.imagen" [alt]="producto.nombre">
        </div>
        <!-- Placeholders para más imágenes -->
        <div class="imagen-miniatura placeholder">
          <i class="fas fa-image"></i>
        </div>
        <div class="imagen-miniatura placeholder">
          <i class="fas fa-image"></i>
        </div>
        <div class="imagen-miniatura placeholder">
          <i class="fas fa-image"></i>
        </div>
      </div>
    </div>

    <!-- Sección de Información -->
    <div class="info-section">
      <!-- Header del producto -->
      <div class="producto-header">
        <h1 class="producto-titulo">{{producto.nombre}}</h1>
        <div class="marca-categoria">
          <span class="marca">{{producto.marca}}</span>
          <span class="categoria">{{getCategoriaDisplay()}}</span>
        </div>
      </div>

      <!-- Precio -->
      <div class="precio-section">
        <div class="precio-info">
          <span class="precio-label">Precio:</span>
          <div class="precios">
            <span class="precio-actual">${{producto.precio}}</span>
            <span *ngIf="producto.precioAnterior" class="precio-anterior">${{producto.precioAnterior}}</span>
          </div>
        </div>
        <div *ngIf="producto.precioAnterior" class="descuento-badge">
          {{calcularDescuento()}}% OFF
        </div>
      </div>

      <!-- Color -->
      <div class="color-section">
        <h3>Color:</h3>
        <div class="color-info">
          <div class="color-muestra" [style.background-color]="getColorHex()"></div>
          <span class="color-nombre">{{producto.color}}</span>
        </div>
      </div>

      <!-- Tallas -->
      <div class="talla-section" *ngIf="producto.tallas.length > 0 && !esTallaStandard()">
        <h3>Talla:</h3>
        <div class="tallas-grid">
          <button *ngFor="let talla of producto.tallas"
                  [class.selected]="tallaSeleccionada === talla"
                  class="talla-btn"
                  (click)="seleccionarTalla(talla)">
            {{talla}}
          </button>
        </div>
        <p *ngIf="!tallaSeleccionada" class="error-message">Por favor selecciona una talla</p>
      </div>

      <!-- Stock -->
      <div class="disponibilidad-section">
        <div class="disponibilidad" [ngClass]="getStockClass()">
          <div class="stock-indicator">
            <div class="stock-dot"></div>
            <span class="stock-text">{{getStockMessage()}}</span>
          </div>
          <div class="stock-bar">
            <div class="stock-fill" [style.width.%]="getStockPercentage()"></div>
          </div>
        </div>
      </div>

      <!-- Cantidad y Botón de agregar -->
      <div class="compra-section">
        <div class="cantidad-controls">
          <label>Cantidad:</label>
          <div class="cantidad-selector">
            <button (click)="cambiarCantidad(-1)" 
                    [disabled]="cantidad <= 1"
                    class="cantidad-btn">
              <i class="fas fa-minus"></i>
            </button>
            <span class="cantidad-display">{{cantidad}}</span>
            <button (click)="cambiarCantidad(1)" 
                    [disabled]="cantidad >= producto.stock"
                    class="cantidad-btn">
              <i class="fas fa-plus"></i>
            </button>
          </div>
        </div>
        
        <button (click)="agregarAlCarrito()"
                [disabled]="!puedeAgregar()"
                class="btn-agregar-carrito">
          <i class="fas fa-shopping-cart"></i>
          Agregar al carrito
        </button>
      </div>

      <!-- Métodos de pago -->
      <div class="metodos-pago-section">
        <h3>Métodos de pago aceptados:</h3>
        <div class="metodos-pago">
          <div class="metodo-pago">
            <i class="fab fa-cc-visa"></i>
            <span>Visa</span>
          </div>
          <div class="metodo-pago">
            <i class="fab fa-cc-mastercard"></i>
            <span>Mastercard</span>
          </div>
        </div>
        <p class="pago-info">Pago 100% seguro con encriptación SSL</p>
      </div>
    </div>
  </div>

  <!-- Secciones expandibles -->
  <div class="secciones-expandibles">
    <!-- Características -->
    <div class="seccion-expandible">
      <button class="seccion-header" (click)="toggleSeccion('caracteristicas')">
        <h3>Características principales</h3>
        <i class="fas" [class.fa-plus]="!seccionesAbiertas.caracteristicas" 
           [class.fa-minus]="seccionesAbiertas.caracteristicas"></i>
      </button>
      <div class="seccion-contenido" [class.abierta]="seccionesAbiertas.caracteristicas">
        <ul class="caracteristicas-lista">
          <li *ngFor="let caracteristica of producto.caracteristicas">
            {{caracteristica}}
          </li>
        </ul>
      </div>
    </div>

    <!-- Descripción -->
    <div class="seccion-expandible">
      <button class="seccion-header" (click)="toggleSeccion('descripcion')">
        <h3>Descripción detallada</h3>
        <i class="fas" [class.fa-plus]="!seccionesAbiertas.descripcion" 
           [class.fa-minus]="seccionesAbiertas.descripcion"></i>
      </button>
      <div class="seccion-contenido" [class.abierta]="seccionesAbiertas.descripcion">
        <p>{{producto.descripcion}}</p>
        <p class="descripcion-adicional">
          Este producto está diseñado con los más altos estándares de calidad para brindar 
          el mejor rendimiento en tu actividad deportiva. Fabricado con materiales duraderos 
          y tecnología avanzada.
        </p>
      </div>
    </div>


  </div>

  <!-- Productos relacionados -->
  <app-productos-relacionados [categoria]="producto.categoria"></app-productos-relacionados>
</div>

<!-- Loading state -->
<div *ngIf="!producto" class="loading-container">
  <div class="loading-spinner">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Cargando producto...</p>
  </div>
</div>
