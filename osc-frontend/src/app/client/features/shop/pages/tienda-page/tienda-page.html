<h1 class="tienda-titulo">Nuestra Tienda</h1>

<section class="tienda-container">
  <!-- Selector de deportes -->
  <div class="deporte-selector-section">
    <app-deporte-selector
      [deporteActivo]="deporteSeleccionado"
      (deporteChange)="onDeporteChange($event)"
    >
    </app-deporte-selector>
  </div>

  <!-- Contenido principal -->
  <div class="tienda-content">
    <!-- Panel de filtros -->
    <aside class="filtros-sidebar">
      <app-filtro-panel [filtrosActivos]="filtrosActivos" (filtrosChange)="onFiltrosChange($event)">
      </app-filtro-panel>
    </aside>
    <!-- Grid de productos -->
    <main class="productos-grid">
      <!-- Skeleton Loading -->
      @if (isLoading) { @for (item of skeletonItems; track $index) {
      <div class="producto-card-skeleton">
        <div class="skeleton-image"></div>
        <div class="skeleton-content">
          <div class="skeleton-text skeleton-title"></div>
          <div class="skeleton-text skeleton-desc"></div>
          <div class="skeleton-text skeleton-price"></div>
          <div class="skeleton-button"></div>
        </div>
      </div>
      } } @else {
      <!-- Productos reales -->
      @for (producto of productos; track producto.id) {
      <app-producto-card [producto]="producto"></app-producto-card>
      }

      <!-- Mensaje cuando no hay productos -->
      @if (productos.length === 0) {
      <div class="no-productos">
        <i class="fas fa-search" style="font-size: 3rem; color: #bdc3c7; margin-bottom: 1rem"></i>
        <p>No se encontraron productos que coincidan con los filtros seleccionados.</p>
        <button class="btn-limpiar-filtros" (click)="limpiarFiltros()">
          Limpiar Filtros
        </button>
      </div>
      }

      <!-- Paginación -->
      @if (totalPaginas > 1) {
      <div class="paginacion">
        <!-- Botón Anterior -->
        <button
          class="btn-pagina"
          [disabled]="filtrosActivos.page === 1"
          (click)="cambiarPagina(filtrosActivos.page! - 1)"
          [class.disabled]="filtrosActivos.page === 1">
          <i class="fas fa-chevron-left"></i>
          Anterior
        </button>

        <!-- Números de página -->
        <div class="paginas-numeros">
          <!-- Primera página -->
          @if (filtrosActivos.page! > 3) {
          <button class="btn-numero-pagina" (click)="cambiarPagina(1)">1</button>
          @if (filtrosActivos.page! > 4) {
          <span class="pagina-dots">...</span>
          }
          }

          <!-- Páginas cercanas -->
          @for (pagina of getPaginasCercanas(); track pagina) {
          <button
            class="btn-numero-pagina"
            [class.active]="pagina === filtrosActivos.page"
            (click)="cambiarPagina(pagina)">
            {{ pagina }}
          </button>
          }

          <!-- Última página -->
          @if (filtrosActivos.page! < totalPaginas - 2) {
          @if (filtrosActivos.page! < totalPaginas - 3) {
          <span class="pagina-dots">...</span>
          }
          <button class="btn-numero-pagina" (click)="cambiarPagina(totalPaginas)">
            {{ totalPaginas }}
          </button>
          }
        </div>

        <!-- Botón Siguiente -->
        <button
          class="btn-pagina"
          [disabled]="filtrosActivos.page === totalPaginas"
          (click)="cambiarPagina(filtrosActivos.page! + 1)"
          [class.disabled]="filtrosActivos.page === totalPaginas">
          Siguiente
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
      }
      }
    </main>
  </div>
</section>
