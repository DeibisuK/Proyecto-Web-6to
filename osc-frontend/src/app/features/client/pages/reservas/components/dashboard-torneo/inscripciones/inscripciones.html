<div class="inscripciones-wrapper">
  <div class="inscripciones-header">
    <div class="header-content">
      <h1 class="page-title">Mis Inscripciones</h1>
      <p class="page-subtitle">Gestiona y revisa tus participaciones en torneos</p>
    </div>
    <button class="btn btn-primary" (click)="openNewInscriptionWizard()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M12 5v14"></path>
        <path d="M5 12h14"></path>
      </svg>
      Nueva Inscripción
    </button>
  </div>

  <!-- Tabs de Estado -->
  <div class="inscripciones-tabs">
    <button
      class="tab"
      [class.active]="activeTab === 'activas'"
      (click)="setActiveTab('activas')">
      Activas
      <span class="tab-badge">{{ getActiveCount() }}</span>
    </button>
    <button
      class="tab"
      [class.active]="activeTab === 'pendientes'"
      (click)="setActiveTab('pendientes')">
      Pendientes
      <span class="tab-badge">{{ getPendingCount() }}</span>
    </button>
    <button
      class="tab"
      [class.active]="activeTab === 'finalizadas'"
      (click)="setActiveTab('finalizadas')">
      Finalizadas
    </button>
  </div>

  <!-- Skeleton Loader -->
  <div class="inscripciones-skeleton" *ngIf="isLoading">
    <div class="skeleton skeleton-card" *ngFor="let item of [1,2,3]"></div>
  </div>

  <!-- Lista de Inscripciones -->
  <div class="inscripciones-content" *ngIf="!isLoading && getFilteredInscripciones().length > 0">
    <div class="inscripcion-card"
         *ngFor="let inscripcion of getFilteredInscripciones(); let i = index"
         [style.animation-delay.s]="i * 0.1"
         class="animate-slide-in">

      <!-- Header de Inscripción -->
      <div class="inscripcion-header">
        <div class="tournament-info">
          <div class="tournament-icon">
            <img [src]="inscripcion.deporte_imagen"
                 [alt]="inscripcion.nombre_deporte">
          </div>
          <div class="tournament-details">
            <h3 class="tournament-name">{{ inscripcion.torneo_nombre }}</h3>
            <p class="tournament-category">{{ inscripcion.nombre_deporte }}</p>
          </div>
        </div>
        <span class="badge" [ngClass]="getStatusBadgeClass(inscripcion.estado_inscripcion)">
          {{ getStatusText(inscripcion.estado_inscripcion) }}
        </span>
      </div>

      <!-- Body de Inscripción -->
      <div class="inscripcion-body">
        <div class="info-grid">
          <div class="info-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            <div class="info-content">
              <span class="info-label">Fecha de Inicio</span>
              <span class="info-value">{{ inscripcion.fecha_inicio | date: 'dd MMM yyyy' }}</span>
            </div>
          </div>

          <div class="info-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <div class="info-content">
              <span class="info-label">Equipo</span>
              <span class="info-value">{{ inscripcion.nombre_equipo }}</span>
            </div>
          </div>

          <div class="info-item" *ngIf="inscripcion.nombre_grupo">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
            <div class="info-content">
              <span class="info-label">Grupo</span>
              <span class="info-value">{{ inscripcion.nombre_grupo }}</span>
            </div>
          </div>

          <div class="info-item" *ngIf="inscripcion.proximo_partido">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <div class="info-content">
              <span class="info-label">Próximo Partido</span>
              <span class="info-value">{{ getProximoPartidoFecha(inscripcion) }}</span>
            </div>
          </div>
        </div>

        <!-- Progress Bar (solo para confirmadas con progreso) -->
        <div class="progress-section"
             *ngIf="inscripcion.aprobado && inscripcion.torneo_estado !== 'finalizado'">
          <div class="progress-header">
            <span class="progress-label">Progreso del Torneo</span>
            <span class="progress-percentage">{{ getProgreso(inscripcion) }}%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="getProgreso(inscripcion)"></div>
          </div>
        </div>
      </div>

      <!-- Footer de Inscripción -->
      <div class="inscripcion-footer">
        <div class="footer-actions">
          <button class="btn btn-secondary btn-sm" (click)="viewDetails(inscripcion)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            Ver Detalles
          </button>

          <button
            class="btn btn-ghost btn-sm text-danger"
            *ngIf="inscripcion.aprobado && puedeCancelar(inscripcion)"
            (click)="cancelInscription(inscripcion, $event)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="15" y1="9" x2="9" y2="15"></line>
              <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
            Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Estado Vacío Mejorado -->
  <div class="empty-state-modern" *ngIf="!isLoading && getFilteredInscripciones().length === 0">
    <div class="empty-animation">
      <div class="empty-icon-large">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
      </div>
    </div>
    <h3>{{ getEmptyStateTitle() }}</h3>
    <p>{{ getEmptyStateMessage() }}</p>
    <button class="btn btn-primary" (click)="openNewInscriptionWizard()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M12 5v14"></path>
        <path d="M5 12h14"></path>
      </svg>
      Inscribirme a un Torneo
    </button>
  </div>
</div>

<!-- Modal de Confirmación -->
<app-confirmacion-modal
  [isOpen]="showConfirmacionModal"
  [config]="confirmacionConfig!"
  (confirmar)="onConfirmacionModalConfirmar()"
  (cancelar)="onConfirmacionModalCancelar()"
  (cerrar)="onConfirmacionModalCerrar()">
</app-confirmacion-modal>
